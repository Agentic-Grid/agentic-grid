# UI Flows Contract Template
# This file defines ALL screens, states, and user interactions.
# RULE: Agents MUST read this before implementing any frontend code.
# Generated by: PLANNER agent during architecture phase (with DESIGNER input)
#
# =============================================================================
# PREMIUM UI MANDATE
# =============================================================================
#
# Every screen in this contract MUST be:
#   - PREMIUM: High-end, polished, worthy of a luxury brand
#   - SOPHISTICATED: Elegant, refined, never cluttered or cheap
#   - ADDICTIVE: Satisfying micro-interactions that make users want to keep using it
#   - DELIGHTFUL: Unexpected moments of joy through animation and feedback
#
# Reference apps for quality standard: Linear, Stripe, Vercel, Notion, Raycast
#
# MANDATORY for every screen:
#   - ALL states defined (loading, error, empty, success)
#   - ALL animations specified (page transitions, hover, click, loading)
#   - ALL micro-interactions documented
#   - Premium visual details (gradients, shadows, polish)
#   - Dark mode variant
#
# =============================================================================

version: "1.0"
project: "{project_name}"
created_at: "{timestamp}"
updated_at: "{timestamp}"

# =============================================================================
# DESIGN SYSTEM REFERENCE
# =============================================================================

design_system:
  tokens_file: "contracts/design-tokens.yaml"
  component_library: "Custom components built on Tailwind CSS"

  # Screen breakpoints (follow for responsive design)
  breakpoints:
    mobile: "< 640px"
    tablet: "640px - 1024px"
    desktop: "> 1024px"

  # Standard spacing (reference these, don't hardcode)
  spacing:
    page_padding: "1rem (mobile) / 2rem (desktop)"
    section_gap: "2rem"
    card_padding: "1.5rem"
    form_gap: "1rem"

# =============================================================================
# NAVIGATION STRUCTURE
# =============================================================================

navigation:
  # Main navigation (header/sidebar)
  main:
    - label: "Dashboard"
      path: "/"
      icon: "home"
      auth_required: true

    - label: "Profile"
      path: "/profile"
      icon: "user"
      auth_required: true

    - label: "Settings"
      path: "/settings"
      icon: "settings"
      auth_required: true

  # Admin navigation (shown to admin users only)
  admin:
    - label: "Users"
      path: "/admin/users"
      icon: "users"
      required_role: admin

    - label: "Analytics"
      path: "/admin/analytics"
      icon: "chart"
      required_role: admin

  # Auth navigation (shown when not logged in)
  auth:
    - label: "Login"
      path: "/login"

    - label: "Sign Up"
      path: "/register"

# =============================================================================
# SCREEN DEFINITIONS
# =============================================================================
# Each screen includes: states, components, actions, and transitions.

screens:
  # ---------------------------------------------------------------------------
  # AUTHENTICATION SCREENS
  # ---------------------------------------------------------------------------
  login:
    path: "/login"
    title: "Sign In"
    auth_required: false
    redirect_if_authenticated: "/"

    layout:
      type: "centered-card"
      max_width: "400px"

    # All possible states this screen can be in
    states:
      idle:
        description: "Initial state, form ready for input"
        components_visible: [form, social_login]

      submitting:
        description: "Form submitted, waiting for response"
        components_visible: [form, loading_overlay]
        form_disabled: true

      error:
        description: "Login failed"
        components_visible: [form, error_message, social_login]
        error_types:
          invalid_credentials: "Invalid email or password"
          rate_limited: "Too many attempts. Please try again in {minutes} minutes."
          network_error: "Unable to connect. Please check your connection."

      success:
        description: "Login successful, redirecting"
        components_visible: [success_message]
        auto_redirect:
          to: "/" # or returnUrl from query params
          delay: 0

    # Components on this screen
    components:
      form:
        type: "form"
        fields:
          email:
            label: "Email"
            type: "email"
            placeholder: "you@example.com"
            validation:
              required: true
              pattern: email
            autocomplete: "email"

          password:
            label: "Password"
            type: "password"
            placeholder: "••••••••"
            validation:
              required: true
              min_length: 8
            autocomplete: "current-password"

          remember_me:
            label: "Remember me"
            type: "checkbox"
            default: false

        submit_button:
          label: "Sign In"
          loading_label: "Signing in..."
          full_width: true

        footer_links:
          - label: "Forgot password?"
            path: "/forgot-password"
          - label: "Don't have an account? Sign up"
            path: "/register"

      social_login:
        type: "social-buttons"
        providers:
          - name: "Google"
            icon: "google"
            action: "oauth_google"
          - name: "GitHub"
            icon: "github"
            action: "oauth_github"
        divider_text: "or continue with"

      error_message:
        type: "alert"
        variant: "error"
        dismissible: true

      loading_overlay:
        type: "spinner"
        overlay: true

      success_message:
        type: "alert"
        variant: "success"
        text: "Login successful! Redirecting..."

    # User actions on this screen
    actions:
      submit_form:
        trigger: "form submit"
        api_call: "POST /api/v1/auth/login"
        on_success: "transition to success state"
        on_error: "transition to error state with error message"

      oauth_google:
        trigger: "click Google button"
        action: "redirect to /api/v1/auth/google"

      oauth_github:
        trigger: "click GitHub button"
        action: "redirect to /api/v1/auth/github"

    # Keyboard shortcuts
    keyboard:
      Enter: "submit form (when form focused)"
      Tab: "move between fields"

  # ---------------------------------------------------------------------------
  register:
    path: "/register"
    title: "Create Account"
    auth_required: false
    redirect_if_authenticated: "/"

    layout:
      type: "centered-card"
      max_width: "400px"

    states:
      idle:
        description: "Initial state"
        components_visible: [form, social_login]

      submitting:
        description: "Creating account"
        components_visible: [form, loading_overlay]
        form_disabled: true

      error:
        description: "Registration failed"
        components_visible: [form, error_message, social_login]
        error_types:
          email_exists: "An account with this email already exists"
          validation_error: "Please check your input and try again"
          network_error: "Unable to connect. Please check your connection."

      success:
        description: "Account created"
        components_visible: [success_message]
        auto_redirect:
          to: "/"
          delay: 1500

    components:
      form:
        type: "form"
        fields:
          name:
            label: "Full Name"
            type: "text"
            placeholder: "John Doe"
            validation:
              required: true
              min_length: 2
              max_length: 100
            autocomplete: "name"

          email:
            label: "Email"
            type: "email"
            placeholder: "you@example.com"
            validation:
              required: true
              pattern: email
            autocomplete: "email"

          password:
            label: "Password"
            type: "password"
            placeholder: "••••••••"
            validation:
              required: true
              min_length: 8
              pattern: "Must include uppercase, lowercase, and number"
            autocomplete: "new-password"
            show_strength_indicator: true

          confirm_password:
            label: "Confirm Password"
            type: "password"
            placeholder: "••••••••"
            validation:
              required: true
              must_match: "password"
            autocomplete: "new-password"

          terms:
            label: "I agree to the Terms of Service and Privacy Policy"
            type: "checkbox"
            validation:
              required: true
            links:
              - text: "Terms of Service"
                path: "/terms"
              - text: "Privacy Policy"
                path: "/privacy"

        submit_button:
          label: "Create Account"
          loading_label: "Creating account..."
          full_width: true

        footer_links:
          - label: "Already have an account? Sign in"
            path: "/login"

      social_login:
        type: "social-buttons"
        providers:
          - name: "Google"
            icon: "google"
            action: "oauth_google"
          - name: "GitHub"
            icon: "github"
            action: "oauth_github"
        divider_text: "or continue with"

      error_message:
        type: "alert"
        variant: "error"
        dismissible: true

      loading_overlay:
        type: "spinner"
        overlay: true

      success_message:
        type: "alert"
        variant: "success"
        text: "Account created! Redirecting..."

    actions:
      submit_form:
        trigger: "form submit"
        api_call: "POST /api/v1/auth/register"
        on_success: "transition to success state"
        on_error: "transition to error state with error message"

  # ---------------------------------------------------------------------------
  # DASHBOARD SCREENS
  # ---------------------------------------------------------------------------
  dashboard:
    path: "/"
    title: "Dashboard"
    auth_required: true

    layout:
      type: "sidebar"
      sidebar_width: "240px"
      content_max_width: "1200px"

    states:
      loading:
        description: "Fetching dashboard data"
        components_visible: [skeleton_loader]

      loaded:
        description: "Data loaded successfully"
        components_visible:
          [welcome_banner, stats_grid, recent_activity, quick_actions]

      error:
        description: "Failed to load data"
        components_visible: [error_state]
        retry_available: true

      empty:
        description: "New user, no data yet"
        components_visible: [welcome_banner, onboarding_steps, quick_actions]

    components:
      welcome_banner:
        type: "banner"
        content: "Welcome back, {user.name}!"
        dismissible: true

      stats_grid:
        type: "grid"
        columns: { mobile: 2, tablet: 3, desktop: 4 }
        items:
          - title: "Total Projects"
            value: "{stats.projects}"
            icon: "folder"
            trend: "+{stats.projects_change}%"
          - title: "Active Tasks"
            value: "{stats.tasks}"
            icon: "check-circle"
          - title: "Team Members"
            value: "{stats.members}"
            icon: "users"
          - title: "Completion Rate"
            value: "{stats.completion}%"
            icon: "chart"

      recent_activity:
        type: "list"
        title: "Recent Activity"
        max_items: 5
        item_template:
          icon: "{activity.type_icon}"
          title: "{activity.title}"
          subtitle: "{activity.relative_time}"
          action: "navigate to {activity.link}"
        empty_state:
          icon: "inbox"
          title: "No recent activity"
          subtitle: "Your recent actions will appear here"

      quick_actions:
        type: "button-group"
        title: "Quick Actions"
        buttons:
          - label: "New Project"
            icon: "plus"
            variant: "primary"
            action: "open_create_project_modal"
          - label: "Invite Team Member"
            icon: "user-plus"
            variant: "secondary"
            action: "open_invite_modal"

      onboarding_steps:
        type: "checklist"
        title: "Get Started"
        items:
          - label: "Complete your profile"
            completed: "{user.profile_complete}"
            action: "navigate to /profile"
          - label: "Create your first project"
            completed: "{stats.projects > 0}"
            action: "open_create_project_modal"
          - label: "Invite a team member"
            completed: "{stats.members > 1}"
            action: "open_invite_modal"

      skeleton_loader:
        type: "skeleton"
        template: "dashboard"

      error_state:
        type: "empty-state"
        icon: "alert-circle"
        title: "Unable to load dashboard"
        subtitle: "Please try again"
        action:
          label: "Retry"
          action: "reload_dashboard"

    data_fetching:
      on_mount:
        - api_call: "GET /api/v1/dashboard/stats"
          store_as: "stats"
        - api_call: "GET /api/v1/dashboard/activity?limit=5"
          store_as: "activity"

      refresh_interval: 60000 # 1 minute

    modals:
      create_project:
        trigger: "quick_actions.new_project"
        component: "CreateProjectModal"

      invite_member:
        trigger: "quick_actions.invite_team_member"
        component: "InviteMemberModal"

  # ---------------------------------------------------------------------------
  # ADD YOUR SCREENS BELOW
  # ---------------------------------------------------------------------------
  # Copy the patterns above for each screen in your application.
  # Remember: Define ALL states, components, and actions.
  # ---------------------------------------------------------------------------

# =============================================================================
# SHARED COMPONENTS
# =============================================================================
# Reusable components referenced across screens

shared_components:
  header:
    type: "header"
    logo: "/logo.svg"
    navigation: "navigation.main"
    user_menu:
      - label: "Profile"
        path: "/profile"
        icon: "user"
      - label: "Settings"
        path: "/settings"
        icon: "settings"
      - divider: true
      - label: "Sign Out"
        action: "logout"
        icon: "log-out"

  sidebar:
    type: "sidebar"
    collapsible: true
    default_collapsed: false
    breakpoint: "desktop" # auto-collapse on mobile/tablet
    navigation: "navigation.main"
    footer:
      - label: "Help & Support"
        path: "/help"
        icon: "help-circle"

  toast_notifications:
    position: "bottom-right"
    duration: 5000
    max_visible: 3
    types:
      success:
        icon: "check-circle"
        bg_color: "green-50"
        border_color: "green-500"
      error:
        icon: "x-circle"
        bg_color: "red-50"
        border_color: "red-500"
      info:
        icon: "info"
        bg_color: "blue-50"
        border_color: "blue-500"

# =============================================================================
# USER FLOWS
# =============================================================================
# End-to-end user journeys across screens

flows:
  new_user_onboarding:
    description: "First-time user from landing page to first project"
    steps:
      1:
        action: "Visit landing page"
        screen: "/landing"
      2:
        action: "Click 'Get Started'"
        transition_to: "/register"
      3:
        action: "Fill registration form"
        screen: "/register"
        state: "idle → submitting → success"
      4:
        action: "Auto-redirect to dashboard"
        screen: "/"
        state: "loading → empty"
      5:
        action: "Click 'Create your first project'"
        opens: "create_project modal"
      6:
        action: "Fill project form, submit"
        screen: "/"
        state: "loaded"

  returning_user_login:
    description: "Existing user logging in"
    steps:
      1:
        action: "Visit login page"
        screen: "/login"
      2:
        action: "Enter credentials, submit"
        screen: "/login"
        state: "idle → submitting → success"
      3:
        action: "Auto-redirect to dashboard"
        screen: "/"
        state: "loading → loaded"

# =============================================================================
# ACCESSIBILITY
# =============================================================================

accessibility:
  focus_management:
    - "Focus first focusable element on route change"
    - "Trap focus in modals"
    - "Return focus to trigger on modal close"

  aria_labels:
    - "All interactive elements must have accessible names"
    - "Use aria-live for dynamic content updates"
    - "Form errors linked via aria-describedby"

  keyboard_navigation:
    - "All functionality available via keyboard"
    - "Visible focus indicators"
    - "Logical tab order"

  color_contrast:
    - "WCAG AA minimum (4.5:1 for normal text)"
    - "Don't convey information by color alone"

# =============================================================================
# USAGE NOTES (DELETE WHEN USING)
# =============================================================================
#
# This contract defines ALL user interface behavior.
#
# WORKFLOW:
# 1. PLANNER creates this file during architecture phase
# 2. DESIGNER reviews and refines component specifications
# 3. FRONTEND agent implements screens exactly as specified
# 4. QA agent validates all states and transitions
#
# RULES:
# - Every screen MUST define all possible states
# - Every state MUST specify which components are visible
# - Every action MUST specify trigger and result
# - Every form field MUST have validation rules
#
# =============================================================================
